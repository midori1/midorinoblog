{% extends "miniblog/blog_base.html" %}
{% load comments %}

{% block title %} 文章列表 {% endblock %}

{% block article %}
    {% for article in articles %}
        <div class="blog-post">
            <h4 class="blog-post-title"><a href="{% url 'miniblog:detail' article.id %}">{{ article.caption }}</a></h4>
            <p class="blog-post-meta">
                {{ article.publish_time }}
                <a href="#">{{ article.author }}</a>
            </p>
            <p class="text-muted">
                {% for tag in article.tags.all %}
                    <i class="icon-tag"></i> <small>{{ tag }}</small>
                {% endfor %}
            </p>
            <div>{{ article.content|truncatewords:50}}</div>

            <div class="row-fluid">
                <div class="span2 offset7">
                    <a href="{% url 'miniblog:delarticle' article.id %}" title="delete"><i class="icon-trash"></i>delete</a>
                    <a href="{% url 'miniblog:updarticle' article.id %}" title="edit"><i class="icon-edit"></i>edit</a>
                    {% get_comment_count for article as comment_count %}
                    <a href="{% url 'miniblog:detail' article.id %}#cmt" title="comment"><i class=" icon-comment"></i>{{ comment_count }}</a>
                </div>
            </div>
            <hr>
        </div>
    {% endfor %}
{% endblock article %}
{% block aside %}   
    <a class="btn" href="{% url 'miniblog:addarticle' %}"><i class="icon-plus"></i> add new blog</a>
    {% block tags %}
        <div class="well">
            {% for tag in tags %}
                <span class="label"><a href="{% url 'miniblog:articlefilter' tag.id %}">{{ tag }}</a></span>
            {% endfor %}
        </div>
    {% endblock %}
{% endblock aside %}
{% block page %}
    <nav>
        <ul class="pagination">
            {% if articles.has_previous %}
                <li><a href="?page={{ articles.previous_page_number }}" aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a></li>
            {% endif %}
            {% for num in articles.paginator.page_range %}
                <li><a href="?page={{ num }}">{{ num }}</a></li>
            {% endfor %}
            {% if articles.has_next %}
                <li><a href="?page={{ articles.next_page_number }}" aria-label='Next'><span aria-hidden='true'>&laquo;</span></a></li>
            {% endif %}
        </ul>
    </nav>
{% endblock page %}